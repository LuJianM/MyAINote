## 基于遗传算法的电子表格自适应表格识别



### 摘要

电子表格是非常成功的内容生成工具，几乎每个企业都使用电子表格来创建丰富的信息。然而，这些信息通常与各种格式、布局和文本元数据混合在一起，因此很难识别和解释表格有效载荷。这一问题主要是利用前人提出的启发式方法来解决的。虽然实现速度很快，但这些方法无法捕获用户生成的电子表格表的高度可变性。因此，本文提出了一种能够适应任意电子表格数据集的监督方法。我们使用图形模型来表示表格的内容，其中包含布局和空间特征。随后，我们将基于遗传的方法应用于图划分，以识别与表中表格相对应的图的部分。表的搜索由一个目标函数指导，该函数经过调整以匹配给定数据集的特定特性。我们在一个大型的，真实世界的电子表格语料库上进行了实验性的评估，以展示这种方法的可行性。



### 介绍

电子表格是强大的内容生成工具，可以帮助新手和专业人士。它们包含的数据基本上是关系型的，但伴随着各种格式、布局和文本元数据。因此，电子表格的内容主要是为人类消费而设计的，并且通常包含隐含的信息。由于这些原因，电子表格中的表格自动识别一直是一项具有挑战性的任务。

特别困难的是多个表与其他非表结构（如列表和注释）共存的情况。总之，这些结构可以在片材内以各种方式排列，进一步增加了复杂性。此外，我们还需要考虑格式和风格工件的存在。例如，单个表的结构可能会被空单元格扭曲，这些单元格用于视觉填充或隐式/缺失值。

目前针对这些挑战的解决方案，如[1]-[3]，大多是基于启发式的，并且受限于创建规则的领域专家的想象力。此外，在将这些规则用于（传输）到其他数据集中之前，需要手动调整这些规则。因此，在本文中，我们提出了一种基本上是自动的方法，它能够根据先前看到的例子（即，在带注释的表格样本上进行训练）来识别近似最优解。

详细地，我们提出了一种采用图模型来表示工作表内容的方法。鉴于此，识别过程可以被描述为对输入图的最优划分的搜索，在这个过程中，得到的部分与表中的表完全对应。我们定义了一个目标函数来确定候选资格的优劣。此函数经过调整以匹配给定数据集的特性。最后，我们使用遗传算法[4]，[5]来寻找全局最优分割。

本文的后续部分安排如下：第二节讨论相关工作。第三节介绍了本文中使用的概念。在第四节中，我们正式定义了提议的表识别方法。我们的实验评估在第五节概述。我们在第六节结束本文。



### 2.相关工作

在电子表格中，有大量的工作涉及布局推理和表格识别，我们提到了那些基于规则和启发式的工作，如[2]、[3]、[6]。其他的作品使用领域特定的语言，如[1]，[7]。最近的出版物在很大程度上适用于机器学习技术[8]-[11]，但总体方法仍然依赖于启发式和/或一般假设。相反，我们避免了关于表的数量、格式和安排的任何假设。此外，据我们所知，我们是第一个使用遗传搜索和图形分割技术来识别电子表格文档中的表的。

值得一提的是，提出了在电子表格中处理公式调试的方法。在[12]-[14]中，与我们类似，检查单个单元格和单元格区域，目的是检测公式中的逻辑错误。

调查[15]，[16]提供了不同文件格式的表格识别技术的全面总结。[17]作者讨论了遗传算法在图像增强和分割中的应用。另外，本文还提出了一种文档图像表识别方法[18]。它使用了一个类似于本工作的图形模型，但其余的是基于规则和启发式。

最后，在文献中有大量的出版物讨论图划分。调查[19]、[20]对现有技术进行了广泛的回顾。在[21]中，他们完全专注于使用遗传算法进行图划分。



### 3.准备工作

#### A. 标签区域（Label Regins）

这项工作利用了标签区域（LR）[2]，[3]的概念，它是一个严格的矩形区域，包含相邻的非空单元格，具有相同的布局角色（Label）。图1 a-c说明了LRs的创建。我们确保每个非空单元格都有一个标签，并且它属于并且只属于一个LR。这里，我们使用三个标签：Header（H）、Data（D）和Metadata（M）。标题是列的标题，描述了它们下面的值。元数据单元提供有关工作表整体或其值子集的附加信息。一些典型的例子是标题、脚注和评论。最后，数据单元是信息的基本单位。与其他两个角色不同，数据单元没有描述他们所持有的价值观以外的其他价值观。可以使用分类器[9]确定单元格的标签-[11] 一。不管算法如何，引用的作品都利用了单元格的特性，如样式、格式、内容类型、文本属性、公式引用等。除此之外，还可以分析附近的单元格，捕捉周围的环境。

#### B. 图形表示法

在[3]中，我们引入了一种图形表示法，它捕捉了纸张标签区域（lr）之间的空间关系。在这项工作中，我们使用相同的表示法，但采用了不同的方法。图中的节点对应于表的LRs。此外，每个节点都使用来自相应LR的特征进行注释，例如其标签和坐标（即区域跨越的行和列）。为跨越同一列或同一行的相邻LR引入边缘，即它们部分或完全对齐，水平或垂直。此外，这些边还添加了其他属性，例如对齐方向和标签区域之间的距离。图1.d展示了左侧示例页的图形表示。连接垂直对齐区域的边为虚线，而水平对齐的边为实心边。如图1.d-e所示，元数据区域被省略。与头和数据不同，这些区域可以与一个或多个表相关。理解这些关系需要一个超越结构的分析（这是本文的工作范围）。因此，我们不考虑结果图模型中的元数据区域。此外，我们在本文的其余部分中省略了它们，并将它们视为未来的工作。





### 四、 建议的方法

正如[19]和[20]所概述的，图划分和聚类是许多应用中研究得很好的问题。使用第III-B节中描述的表示，我们将电子表格（TRS）中的表识别任务描述为一个图划分问题（GPP）。





